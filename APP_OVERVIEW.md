# Resilient Mesh Nav - アプリ概要

##　作品名
慣れない土地での災害時、情報収集と団体での安全確保をオフラインでも可能にする、オールインワンの防災・連携アプリ。

## 作品概要
災害時に外国人観光客が避難や情報共有で困難を抱える課題に対し、GISやGTFSなどのオープンデータを活用し、ネットワークが遮断された状況でもBluetooth通信で近くの人と情報を共有・連携できる多言語対応アプリ。

### 解決する課題
1. **通信インフラの寸断**: 災害時に携帯電話やインターネットが使えない状況でも、周辺住民と連絡を取り合える
2. **多様性への対応**: 多言語・多文化背景を持つ住民が、言語の壁を越えて共助できる
3. **避難弱者への支援**: 高齢者、障害者、妊婦、外国人など、避難時に特別な配慮が必要な人々を支援する仕組みを提供
4. **情報格差の解消**: 災害情報や避難情報を、わかりやすい形で提供

## ターゲットユーザー

### プライマリターゲット
- **地域住民全般**: 災害時に共助が必要なすべての住民
- **外国人住民**: 日本語が不自由な外国人住民（中国語、英語、スペイン語、韓国語話者など）
- **避難弱者**: 高齢者、障害者、妊婦、乳幼児連れの家族など

### セカンダリターゲット
- **地域コミュニティ**: 事前にグループを形成して、災害時に安否確認を行う家族・友人グループ
- **支援者**: 災害時に周辺住民を支援できるスキル（応急処置、多言語対応、力仕事など）を持つ人

## 主要機能

### 1. 災害情報・避難情報の提供（ホーム画面）
- **現在の情報**: 最新の災害情報、避難警報、最終更新日時を表示
- **避難に関する情報**: 避難の必要性、避難までの時間、避難所情報
- **学びのコラム**: 
  - 適切な応急処置方法
  - 女性向け情報（避難所での安全対策、必要な物品）
  - 過去の災害から学ぶ
- **持ち出し品チェックリスト**: 避難時に必要な物品をチェックリスト形式で管理
- **緊急連絡先**: 家族、友人、緊急連絡先を登録・管理

### 2. オフライン共助機能（コミュニティ画面）

#### 2.1 周辺ユーザー探索（レーダー機能）
- **Bluetooth Mesh通信**: 半径50m以内のアプリユーザーを自動検索
- **多言語フィルター**: 日本語、英語、中国語、スペイン語、韓国語などでフィルタリング
- **ユーザー情報表示**:
  - 距離（メートル単位）
  - バッテリー残量
  - ステータス（OK、SOS、不明）
  - スキル（力仕事、応急処置、多言語対応など）
  - 支援が必要な事項（怪我、妊娠中など）
- **信頼できるメンバー表示**: 事前に登録したグループメンバーを優先表示

#### 2.2 オフライン・チャット
- **1対1チャット**: 周辺ユーザーと個別にメッセージを交換
- **グループチャット**: 家族や友人グループで情報共有
- **地域掲示板**: 地域全体への情報発信（避難所情報、支援要請など）
- **クイックリプライ**: よく使う返信をワンタップで送信
- **多言語対応**: メッセージの自動翻訳機能（構造のみ実装済み）

#### 2.3 グループ安否確認
- **事前登録グループ**: 家族、友人、地域コミュニティなどのグループを事前に登録
- **安否ステータス確認**: グループメンバーの現在のステータス（OK、SOS、不明）を一覧表示
- **位置情報共有**: グループメンバーの現在位置を地図上で確認
- **バッテリー残量表示**: 各メンバーのデバイスバッテリー残量を表示

#### 2.4 プロフィール・支援設定
- **スキル登録**: 
  - 力仕事ができます
  - 応急処置ができます
  - 多言語対応（英語、スペイン語など）
  - 子連れのサポートができます
- **支援が必要な事項**: 持病、妊娠中、障害など
- **宗教的配慮**: ハラール対応など
- **つながり一覧**: 登録したグループやつながりの一覧

### 3. マップ機能
- **オフラインマップ**: 事前にダウンロードした地図をオフラインで表示
- **避難経路表示**: 現在地から避難所までの最適な避難経路を表示
- **家族の位置表示**: グループメンバーの現在位置を地図上で確認
- **避難所マーカー**: 近隣の避難所を地図上で表示
- **家族ステータスカード**: 家族の現在のステータス（無事、避難所到着など）を表示

### 4. 緊急時機能
- **SOS発信**: 緊急時に周辺ユーザーにSOS信号を送信
- **安否ステータス送信**: 現在の安否状況（OK、SOS）を周辺ユーザーに送信
- **緊急連絡先への電話**: 登録した緊急連絡先に直接電話をかける

### 5. グループ管理機能
- **グループ作成**: 家族、友人、地域コミュニティなどのグループを作成
- **メンバー追加**: 信頼できるメンバーをグループに追加
- **グループ一覧**: 登録したグループの一覧を表示

## 技術的特徴

### オフライン動作
- **Bluetooth Mesh通信**: インターネット接続がなくても、Bluetooth経由で周辺デバイスと通信
- **ローカルデータ保存**: SharedPreferencesを使用して、ユーザー情報やグループ情報をローカルに保存
- **オフラインマップ**: 事前にダウンロードした地図タイルをローカルに保存

### 多言語・多文化対応
- **多言語UI**: 日本語、英語、中国語、スペイン語、韓国語などに対応（構造のみ実装済み）
- **言語フィルター**: チャットや周辺ユーザー探索で、使用言語でフィルタリング
- **やさしい日本語**: 専門用語を避け、わかりやすい表現を使用
- **ピクトグラム活用**: ISO準拠のピクトグラムを多用し、言語に依存しない情報伝達

### ユーザビリティ
- **直感的なUI**: 色分けによる直感的な理解（赤=SOS、緑=OK）
- **ワンタップ操作**: 緊急時に簡単に操作できる大きなボタン
- **視覚的な情報表示**: アイコン、ピクトグラム、色分けを活用

## 使用技術

### フロントエンド
- **Flutter**: クロスプラットフォーム対応（iOS、Android、Web）
- **Riverpod**: 状態管理
- **go_router**: ルーティング

### 地図・位置情報
- **flutter_map**: 地図表示
- **latlong2**: 座標計算
- **geolocator**: 位置情報取得

### 通信
- **flutter_blue_plus**: Bluetooth通信（モバイル版のみ）
- **Bluetooth Mesh**: オフラインP2P通信（実装中）

### データ管理
- **SharedPreferences**: ローカルデータ保存
- **Freezed**: イミュータブルなデータモデル
- **json_serializable**: JSONシリアライゼーション

## 実装状況

### 実装済み
- ✅ すべての画面の基本構造とUI
- ✅ ルーティング設定
- ✅ モックデータによるUI表示
- ✅ 持ち出し品チェックリスト機能
- ✅ 緊急連絡先管理機能
- ✅ チャット機能（UI）
- ✅ 周辺ユーザー探索機能（UI）
- ✅ マップ機能（地図表示、マーカー、ポリライン）
- ✅ グループ管理機能（UI）

### 実装中・未実装
- 🔄 Bluetooth Mesh通信の実装（構造のみ実装済み）
- 🔄 実際のBluetoothデバイス検索・通信
- 🔄 メッセージの自動翻訳機能
- 🔄 オフラインマップのダウンロード機能
- 🔄 位置情報のリアルタイム更新
- 🔄 実際の災害情報APIとの連携

## 想定される使用シーン

### 日常時
- 防災準備: 持ち出し品チェックリストの確認、緊急連絡先の登録
- グループ形成: 家族や友人とグループを作成し、災害時の連絡先を事前に登録
- 学習: 学びのコラムで応急処置や避難方法を学習

### 災害発生時
- 情報収集: 最新の災害情報、避難警報を確認
- 安否確認: グループメンバーの安否を確認
- 周辺探索: 周辺にいる支援可能な人や支援が必要な人を探索
- 共助: チャット機能で周辺住民と情報共有、支援要請・提供
- 避難: マップ機能で避難経路を確認し、避難所へ移動

### 避難所到着後
- 家族との連絡: 避難所に到着したことを家族に通知
- 地域掲示板: 避難所の情報や支援要請を地域全体に発信
- 支援提供: 自分のスキル（応急処置、多言語対応など）を提供

## 社会的意義

### 1. 災害時の共助促進
- 通信インフラが寸断されても、Bluetooth Mesh通信で周辺住民と連絡を取り合える
- 支援が必要な人と支援できる人をマッチング

### 2. 多様性への対応
- 多言語・多文化背景を持つ住民が、言語の壁を越えて共助できる
- 宗教的配慮（ハラールなど）を考慮した支援

### 3. 避難弱者への支援
- 高齢者、障害者、妊婦、外国人など、避難時に特別な配慮が必要な人々を支援
- スキルマッチングにより、適切な支援を提供

### 4. 地域コミュニティの強化
- 事前にグループを形成することで、災害時の連携を強化
- 地域全体での情報共有により、地域コミュニティの結束を強化

## 今後の展開

### 短期
- Bluetooth Mesh通信の完全実装
- オフラインマップのダウンロード機能
- 実際の災害情報APIとの連携

### 中期
- メッセージの自動翻訳機能の実装
- 位置情報のリアルタイム更新
- プッシュ通知機能

### 長期
- AIを活用した支援マッチング
- 災害予測と事前避難の推奨
- 他地域への展開

